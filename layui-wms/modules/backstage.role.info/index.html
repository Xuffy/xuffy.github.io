<style>.dx-manage-info{padding-top:23px!important;padding-left:38px;padding-right:38px;position:relative}.dx-manage-info .btn-box{position:absolute;right:0}.dx-manage-info .btn-box .layui-btn{width:120px}.dx-manage-info h2.title{font-size:16px;color:#333;border-left:solid 5px #fab530;padding-left:7px}.dx-manage-info .waterfall-box{-webkit-column-width:250px;-moz-column-width:250px;-o-colum-width:250px}.dx-manage-info .function-box{background-color:#f0f2f5;border:solid 1px #e4e4e4;margin-top:15px;margin-bottom:15px;width:250px;position:relative;padding-top:50px;display:inline-block;margin-right:10px}.dx-manage-info .function-box h5.title{width:100%;border:solid 1px #a5abb7;background-color:#a5abb7;color:#fff;font-size:14px;line-height:30px;position:absolute;top:-1px;left:-1px}.dx-manage-info .function-box h5.title i{margin-right:5px;margin-left:10px}.dx-manage-info .function-box .list-item{padding-bottom:5px}.dx-manage-info .function-box .list-item li{padding-left:30px}.dx-manage-info .function-box .list-item li:first-child{padding-left:0}.dx-manage-info .function-box .list-item .layui-form-checkbox{padding-left:30px;padding-right:0}.dx-manage-info .function-box .list-item .layui-form-checkbox i{left:-7px}.dx-manage-info.type-info .btn-box{display:none}.dx-manage-info.dx-info-box.type-info input{border:solid 1px #e6e6e6!important}.dx-manage-info.dx-info-box.type-info .layui-checkbox-disbaled.layui-form-checked:hover i{color:#6a96df!important}.dx-manage-info.dx-info-box.type-info .layui-checkbox-disbaled.layui-form-checked{border-color:#6a96df!important}.dx-manage-info.dx-info-box.type-info .layui-checkbox-disbaled.layui-form-checked span{background-color:#6a96df!important}</style>

<section class="dx-info-default">
  <div class="dx-info-box dx-manage-info">
    <form class="layui-form layui-form-pane dx-form-pane">
      <div class="layui-form-item">
        <label class="layui-form-label">角色名称</label>
        <div class="layui-input-inline">
          <input type="text" name="username" lay-verify="required" placeholder="请输入新增角色名称" autocomplete="off"
                 class="layui-input">
        </div>
        <button class="layui-btn btn-yellow" type="button">查询</button>
      </div>
      <div class="layui-form-item btn-box">
        <div class="layui-input-block">
          <button type="reset" class="layui-btn layui-btn-primary btn-simple-blue">重置</button>
          <button class="layui-btn" lay-submit="" lay-filter="demo1">提交</button>
        </div>
      </div>

      <h2 class="title">角色功能选择</h2>

      <div class="waterfall-box">

        <div class="function-box">
          <h5 class="title"><i class="iconfont icon-xiangmu"></i>后台用户管理</h5>
          <ul class="list-item">
            <li><input type="checkbox" name="like[write]" title="后台用户" lay-filter="checkbox" parentCheckBox="true"></li>
            <li><input type="checkbox" name="like[write]" title="新增" lay-filter="checkbox" checked></li>
            <li><input type="checkbox" name="like[read]" title="查看" lay-filter="checkbox"></li>
            <li><input type="checkbox" name="like[game]" title="修改" lay-filter="checkbox" checked></li>
            <li>
              <ul class="list-item">
                <li><input type="checkbox" name="like[write]" title="后台用户" lay-filter="checkbox" parentCheckBox="true">
                </li>
                <li><input type="checkbox" name="like[write]" title="新增" lay-filter="checkbox"></li>
                <li><input type="checkbox" name="like[read]" title="查看" lay-filter="checkbox" checked></li>
                <li><input type="checkbox" name="like[game]" title="修改" lay-filter="checkbox"></li>
                <li><input type="checkbox" name="like[game]" title="启用/禁用" lay-filter="checkbox"></li>
              </ul>
            </li>
          </ul>
          <ul class="list-item">
            <li><input type="checkbox" name="like[write]" title="后台角色" lay-filter="checkbox" parentCheckBox="true"></li>
            <li><input type="checkbox" name="like[write]" title="新增" lay-filter="checkbox"></li>
            <li><input type="checkbox" name="like[read]" title="查看" lay-filter="checkbox"></li>
            <li><input type="checkbox" name="like[game]" title="修改" lay-filter="checkbox"></li>
            <li><input type="checkbox" name="like[game]" title="删除" lay-filter="checkbox"></li>
          </ul>
          <ul class="list-item">
            <li><input type="checkbox" name="like[write]" title="后台角色" lay-filter="checkbox" parentCheckBox="true"></li>
            <li><input type="checkbox" name="like[write]" title="权限维护" lay-filter="checkbox"></li>
            <li><input type="checkbox" name="like[read]" title="查看" lay-filter="checkbox"></li>
            <li><input type="checkbox" name="like[game]" title="修改" lay-filter="checkbox"></li>
            <li><input type="checkbox" name="like[game]" title="删除" lay-filter="checkbox"></li>
          </ul>
          <ul class="list-item">
            <li><input type="checkbox" name="like[write]" title="权限维护" lay-filter="checkbox"></li>
          </ul>
        </div>

        <div class="function-box">
          <h5 class="title"><i class="iconfont icon-xiangmu"></i>APP用户管理</h5>
          <ul class="list-item">
            <li><input type="checkbox" name="like[write]" title="后台用户" lay-filter="checkbox" parentCheckBox="true"></li>
            <li><input type="checkbox" name="like[write]" title="新增" lay-filter="checkbox"></li>
            <li><input type="checkbox" name="like[read]" title="查看" lay-filter="checkbox"></li>
            <li><input type="checkbox" name="like[game]" title="修改" lay-filter="checkbox"></li>
            <li><input type="checkbox" name="like[game]" title="禁用" lay-filter="checkbox"></li>
          </ul>
          <ul class="list-item">
            <li><input type="checkbox" name="like[write]" title="黑名单" lay-filter="checkbox" parentCheckBox="true"></li>
            <li><input type="checkbox" name="like[read]" title="查看" lay-filter="checkbox"></li>
            <li><input type="checkbox" name="like[game]" title="修改">
            <li><input type="checkbox" name="like[game]" title="启用" lay-filter="checkbox"></li>
          </ul>
        </div>

        <div class="function-box">
          <h5 class="title"><i class="iconfont icon-xiangmu"></i>业务设置</h5>
          <ul class="list-item">
            <li><input type="checkbox" name="like[write]" title="实验人员角色" lay-filter="checkbox" parentCheckBox="true"></li>
            <li><input type="checkbox" name="like[write]" title="新增" lay-filter="checkbox"></li>
            <li><input type="checkbox" name="like[read]" title="查看" lay-filter="checkbox"></li>
            <li><input type="checkbox" name="like[game]" title="修改" lay-filter="checkbox"></li>
            <li><input type="checkbox" name="like[game]" title="删除" lay-filter="checkbox"></li>
          </ul>
          <ul class="list-item">
            <li><input type="checkbox" name="like[write]" title="实验人员权限" lay-filter="checkbox" parentCheckBox="true"></li>
            <li><input type="checkbox" name="like[read]" title="查看" lay-filter="checkbox"></li>
            <li><input type="checkbox" name="like[game]" title="启用" lay-filter="checkbox"></li>
          </ul>
        </div>

        <div class="function-box">
          <h5 class="title"><i class="iconfont icon-xiangmu"></i>后台用户管理</h5>
          <ul class="list-item">
            <li><input type="checkbox" name="like[write]" title="后台用户" lay-filter="checkbox" parentCheckBox="true"></li>
            <li><input type="checkbox" name="like[write]" title="新增" lay-filter="checkbox"></li>
            <li><input type="checkbox" name="like[read]" title="查看" lay-filter="checkbox"></li>
            <li><input type="checkbox" name="like[game]" title="修改" lay-filter="checkbox"></li>
            <li><input type="checkbox" name="like[game]" title="启用/禁用" lay-filter="checkbox"></li>
          </ul>
          <ul class="list-item">
            <li><input type="checkbox" name="like[write]" title="后台角色" lay-filter="checkbox" parentCheckBox="true"></li>
            <li><input type="checkbox" name="like[write]" title="新增" lay-filter="checkbox"></li>
            <li><input type="checkbox" name="like[read]" title="查看" lay-filter="checkbox"></li>
            <li><input type="checkbox" name="like[game]" title="修改" lay-filter="checkbox"></li>
            <li><input type="checkbox" name="like[game]" title="删除" lay-filter="checkbox"></li>
          </ul>
          <ul class="list-item">
            <li><input type="checkbox" name="like[write]" title="后台角色" lay-filter="checkbox" parentCheckBox="true"></li>
            <li><input type="checkbox" name="like[write]" title="权限维护" lay-filter="checkbox"></li>
            <li><input type="checkbox" name="like[read]" title="查看" lay-filter="checkbox"></li>
            <li><input type="checkbox" name="like[game]" title="修改" lay-filter="checkbox"></li>
            <li><input type="checkbox" name="like[game]" title="删除" lay-filter="checkbox"></li>
          </ul>
          <ul class="list-item">
            <li><input type="checkbox" name="like[write]" title="权限维护" lay-filter="checkbox"></li>
          </ul>
        </div>

        <div class="function-box">
          <h5 class="title"><i class="iconfont icon-xiangmu"></i>APP用户管理</h5>
          <ul class="list-item">
            <li><input type="checkbox" name="like[write]" title="后台用户" lay-filter="checkbox" parentCheckBox="true"></li>
            <li><input type="checkbox" name="like[write]" title="新增" lay-filter="checkbox"></li>
            <li><input type="checkbox" name="like[read]" title="查看" lay-filter="checkbox"></li>
            <li><input type="checkbox" name="like[game]" title="修改" lay-filter="checkbox"></li>
            <li><input type="checkbox" name="like[game]" title="禁用" lay-filter="checkbox"></li>
          </ul>
          <ul class="list-item">
            <li><input type="checkbox" name="like[write]" title="黑名单" lay-filter="checkbox" parentCheckBox="true"></li>
            <li><input type="checkbox" name="like[read]" title="查看" lay-filter="checkbox"></li>
            <li><input type="checkbox" name="like[game]" title="修改" lay-filter="checkbox"></li>
            <li><input type="checkbox" name="like[game]" title="启用" lay-filter="checkbox"></li>
          </ul>
        </div>

        <div class="function-box">
          <h5 class="title"><i class="iconfont icon-xiangmu"></i>业务设置</h5>
          <ul class="list-item">
            <li><input type="checkbox" name="like[write]" title="实验人员角色" lay-filter="checkbox" parentCheckBox="true"></li>
            <li><input type="checkbox" name="like[write]" title="新增" lay-filter="checkbox"></li>
            <li><input type="checkbox" name="like[read]" title="查看" lay-filter="checkbox"></li>
            <li><input type="checkbox" name="like[game]" title="修改" lay-filter="checkbox"></li>
            <li><input type="checkbox" name="like[game]" title="删除" lay-filter="checkbox"></li>
          </ul>
          <ul class="list-item">
            <li><input type="checkbox" name="like[write]" title="实验人员权限" lay-filter="checkbox" parentCheckBox="true"></li>
            <li><input type="checkbox" name="like[read]" title="查看" lay-filter="checkbox"></li>
            <li><input type="checkbox" name="like[game]" title="启用" lay-filter="checkbox"></li>
          </ul>
        </div>

        <div class="function-box">
          <h5 class="title"><i class="iconfont icon-xiangmu"></i>后台用户管理</h5>
          <ul class="list-item">
            <li><input type="checkbox" name="like[write]" title="后台用户" lay-filter="checkbox" parentCheckBox="true"></li>
            <li><input type="checkbox" name="like[write]" title="新增" lay-filter="checkbox"></li>
            <li><input type="checkbox" name="like[read]" title="查看" lay-filter="checkbox"></li>
            <li><input type="checkbox" name="like[game]" title="修改" lay-filter="checkbox"></li>
            <li><input type="checkbox" name="like[game]" title="启用/禁用" lay-filter="checkbox"></li>
          </ul>
          <ul class="list-item">
            <li><input type="checkbox" name="like[write]" title="后台角色" lay-filter="checkbox" parentCheckBox="true"></li>
            <li><input type="checkbox" name="like[write]" title="新增" lay-filter="checkbox"></li>
            <li><input type="checkbox" name="like[read]" title="查看" lay-filter="checkbox"></li>
            <li><input type="checkbox" name="like[game]" title="修改" lay-filter="checkbox"></li>
            <li><input type="checkbox" name="like[game]" title="删除" lay-filter="checkbox"></li>
          </ul>
          <ul class="list-item">
            <li><input type="checkbox" name="like[write]" title="后台角色" lay-filter="checkbox" parentCheckBox="true"></li>
            <li><input type="checkbox" name="like[write]" title="权限维护" lay-filter="checkbox"></li>
            <li><input type="checkbox" name="like[read]" title="查看" lay-filter="checkbox"></li>
            <li><input type="checkbox" name="like[game]" title="修改" lay-filter="checkbox"></li>
            <li><input type="checkbox" name="like[game]" title="删除" lay-filter="checkbox"></li>
          </ul>
          <ul class="list-item">
            <li><input type="checkbox" name="like[write]" title="权限维护" lay-filter="checkbox"></li>
          </ul>
        </div>

        <div class="function-box">
          <h5 class="title"><i class="iconfont icon-xiangmu"></i>APP用户管理</h5>
          <ul class="list-item">
            <li><input type="checkbox" name="like[write]" title="后台用户" lay-filter="checkbox" parentCheckBox="true"></li>
            <li><input type="checkbox" name="like[write]" title="新增" lay-filter="checkbox"></li>
            <li><input type="checkbox" name="like[read]" title="查看" lay-filter="checkbox"></li>
            <li><input type="checkbox" name="like[game]" title="修改" lay-filter="checkbox"></li>
            <li><input type="checkbox" name="like[game]" title="禁用" lay-filter="checkbox"></li>
          </ul>
          <ul class="list-item">
            <li><input type="checkbox" name="like[write]" title="黑名单" lay-filter="checkbox" parentCheckBox="true"></li>
            <li><input type="checkbox" name="like[read]" title="查看" lay-filter="checkbox"></li>
            <li><input type="checkbox" name="like[game]" title="修改" lay-filter="checkbox"></li>
            <li><input type="checkbox" name="like[game]" title="启用" lay-filter="checkbox"></li>
          </ul>
        </div>

        <div class="function-box">
          <h5 class="title"><i class="iconfont icon-xiangmu"></i>业务设置</h5>
          <ul class="list-item">
            <li><input type="checkbox" name="like[write]" title="实验人员角色" lay-filter="checkbox" parentCheckBox="true"></li>
            <li><input type="checkbox" name="like[write]" title="新增" lay-filter="checkbox"></li>
            <li><input type="checkbox" name="like[read]" title="查看" lay-filter="checkbox"></li>
            <li><input type="checkbox" name="like[game]" title="修改" lay-filter="checkbox"></li>
            <li><input type="checkbox" name="like[game]" title="删除" lay-filter="checkbox"></li>
          </ul>
          <ul class="list-item">
            <li><input type="checkbox" name="like[write]" title="实验人员权限" lay-filter="checkbox" parentCheckBox="true"></li>
            <li><input type="checkbox" name="like[read]" title="查看" lay-filter="checkbox"></li>
            <li><input type="checkbox" name="like[game]" title="启用" lay-filter="checkbox"></li>
          </ul>
        </div>

        <div class="function-box">
          <h5 class="title"><i class="iconfont icon-xiangmu"></i>后台用户管理</h5>
          <ul class="list-item">
            <li><input type="checkbox" name="like[write]" title="后台用户" lay-filter="checkbox" parentCheckBox="true"></li>
            <li><input type="checkbox" name="like[write]" title="新增" lay-filter="checkbox"></li>
            <li><input type="checkbox" name="like[read]" title="查看" lay-filter="checkbox"></li>
            <li><input type="checkbox" name="like[game]" title="修改" lay-filter="checkbox"></li>
            <li><input type="checkbox" name="like[game]" title="启用/禁用" lay-filter="checkbox"></li>
          </ul>
          <ul class="list-item">
            <li><input type="checkbox" name="like[write]" title="后台角色" lay-filter="checkbox" parentCheckBox="true"></li>
            <li><input type="checkbox" name="like[write]" title="新增" lay-filter="checkbox"></li>
            <li><input type="checkbox" name="like[read]" title="查看" lay-filter="checkbox"></li>
            <li><input type="checkbox" name="like[game]" title="修改" lay-filter="checkbox"></li>
            <li><input type="checkbox" name="like[game]" title="删除" lay-filter="checkbox"></li>
          </ul>
          <ul class="list-item">
            <li><input type="checkbox" name="like[write]" title="后台角色" lay-filter="checkbox" parentCheckBox="true"></li>
            <li><input type="checkbox" name="like[write]" title="权限维护" lay-filter="checkbox"></li>
            <li><input type="checkbox" name="like[read]" title="查看" lay-filter="checkbox"></li>
            <li><input type="checkbox" name="like[game]" title="修改" lay-filter="checkbox"></li>
            <li><input type="checkbox" name="like[game]" title="删除" lay-filter="checkbox"></li>
          </ul>
          <ul class="list-item">
            <li><input type="checkbox" name="like[write]" title="权限维护" lay-filter="checkbox"></li>
          </ul>
        </div>

        <div class="function-box">
          <h5 class="title"><i class="iconfont icon-xiangmu"></i>APP用户管理</h5>
          <ul class="list-item">
            <li><input type="checkbox" name="like[write]" title="后台用户" lay-filter="checkbox" parentCheckBox="true"></li>
            <li><input type="checkbox" name="like[write]" title="新增" lay-filter="checkbox"></li>
            <li><input type="checkbox" name="like[read]" title="查看" lay-filter="checkbox"></li>
            <li><input type="checkbox" name="like[game]" title="修改" lay-filter="checkbox"></li>
            <li><input type="checkbox" name="like[game]" title="禁用" lay-filter="checkbox"></li>
          </ul>
          <ul class="list-item">
            <li><input type="checkbox" name="like[write]" title="黑名单" lay-filter="checkbox" parentCheckBox="true"></li>
            <li><input type="checkbox" name="like[read]" title="查看" lay-filter="checkbox"></li>
            <li><input type="checkbox" name="like[game]" title="修改" lay-filter="checkbox"></li>
            <li><input type="checkbox" name="like[game]" title="启用" lay-filter="checkbox"></li>
          </ul>
        </div>

        <div class="function-box">
          <h5 class="title"><i class="iconfont icon-xiangmu"></i>业务设置</h5>
          <ul class="list-item">
            <li><input type="checkbox" name="like[write]" title="实验人员角色" lay-filter="checkbox" parentCheckBox="true"></li>
            <li><input type="checkbox" name="like[write]" title="新增" lay-filter="checkbox"></li>
            <li><input type="checkbox" name="like[read]" title="查看" lay-filter="checkbox"></li>
            <li><input type="checkbox" name="like[game]" title="修改" lay-filter="checkbox"></li>
            <li><input type="checkbox" name="like[game]" title="删除" lay-filter="checkbox"></li>
          </ul>
          <ul class="list-item">
            <li><input type="checkbox" name="like[write]" title="实验人员权限" lay-filter="checkbox" parentCheckBox="true"></li>
            <li><input type="checkbox" name="like[read]" title="查看" lay-filter="checkbox"></li>
            <li><input type="checkbox" name="like[game]" title="启用" lay-filter="checkbox"></li>
          </ul>
        </div>
      </div>
    </form>
  </div>
</section>

<script type="text/javascript">'use strict';

layui.use(['form', '_route'], function () {
  var form = layui.form()
    , _route = layui._route
    , layer = layui.layer
    , curPosition = ''
    , boxEle = $('.dx-info-box');

  // 状态判断
  switch (_route.params.type) {
    case 'add':
      curPosition = '新增';
      boxEle.addClass('type-add');
      break;
    case 'update':
      curPosition = '修改';
      boxEle.addClass('type-update');
      break;
    case 'info':
      curPosition = '查看';
      boxEle.addClass('type-info').find('input[type="checkbox"]').attr('disabled', 'disabled');
      break;
  }

  // 初始化当前位置
  _route.setBreadcrumb(['后台用户管理', {url: 'backstage.user', name: '后台角色'}, curPosition]);

  // 渲染表单
  form.render();

  // 监听checkbox点击
  form.on('checkbox(checkbox)', function (data) {
    var pck = $(data.elem).parent().parent();

    // 判断是否全选
    if ($(data.elem).attr('parentCheckBox')) {
      if (data.elem.checked) {
        pck.find('.layui-form-checkbox').addClass('layui-form-checked');
        _.map(pck.find('input[type="checkbox"]'), function (val) {
          val.checked = true;
        });
      } else {
        pck.find('.layui-form-checkbox').removeClass('layui-form-checked');
        _.map(pck.find('input[type="checkbox"]'), function (val) {
          val.checked = false;
        });
      }
    } else {
      if (!data.elem.checked) {
        pck.find('input[parentCheckBox]').eq(0).next('.layui-form-checkbox').removeClass('layui-form-checked')[0].checked = false;
      }
    }
  });

  // 监听增加按钮
  $('#add,.user-info,.user-update').on('click', function () {
    _route.go('backstage.user.info', {type: $(this).attr('dx-type')});
  });


  // 监听禁用按钮
  $('.user-delete').on('click', function () {
    layer.confirm('确定删除此角色？', {
      btn: ['确定', '取消']
    }, function (index, layero) {
      layer.msg('删除了')
    });
  });


  // 监听提交按钮
  form.on('submit(search)', function (data) {
    layer.alert(JSON.stringify(data.field), {
      title: '最终的提交信息'
    });
    return false;
  });

});</script>