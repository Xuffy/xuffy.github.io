"use strict";!function(){function e(){document.body.addEventListener("touchmove",function(e){e.preventDefault()},!1)}var t,i,a,s,c=5,n=3,r=6,d=[],o=[],v={};t="n"+r,v.step=v.step||"game-select",e(),new Vue({el:"#index",created:function(){switch(v.step){case"game-select":$("#select-card-box").removeClass("onw-hide"),this.gameSelect()}},data:{game:v,updatePage:0,playerNum:0},methods:{clickCard:function(e,t){var i=$(e.currentTarget);switch(v.step){case"game-select":var a=0;t.active=!t.active,a=_.where(this.$data.game.roleList,{active:!0}).length,this.$data.playerNum=a>5?a-3:0;break;case"game-distribution":this.gameDistribution(i)}this.$data.updatePage=Math.random()},clickStartGame:function(){_.findWhere(this.$data.game.roleList,{type:"WEREWOLF",active:!0})?this.$data.playerNum>12?alert("最多12个玩家"):(o=_.where(this.$data.game.roleList,{active:!0}),$("#select-card-box").addClass("onw-hide"),$("#card-box").removeClass("onw-hide")):alert("未选择狼人")},gameSelect:function(){v.roleList=[],_.map(ALL_ROLE,function(e){for(var t=0;t<e.maxNum;t++)v.roleList.push(_.clone(e))})},gameDistribution:function(e){return"transverse"===v.screenType&&",6,7,8,".indexOf(","+e.index()+",")>-1||"vertical"===v.screenType&&",4,7,10,".indexOf(","+e.index()+",")>-1?!1:void e.removeClass("game-distribution").css({"z-index":1})},initGame:function(){var e,r,o=[];i=$.device.w>$.device.h?$.device.h:$.device.w,a=$.device.w>$.device.h?$.device.w:$.device.h,e=(i-10*(n+1))/n,r=(a-10*(n+1))/c,s=parseInt(e>r?r:e),$(".card-item").width(s).height(s),_.map(ALL_ROLE,function(e){if(!_.isEmpty(e.assignment)&&e.assignment[t])for(var i=0;i<e.assignment[t];i++)d.push(e)}),d=_.shuffle(d);for(var h=1;c*n>=h;h++){var m=$.device.w>$.device.h?ROLE_SEAT[t].w:ROLE_SEAT[t].h;m.indexOf(","+h+",")>-1?o.push({}):(o.push(d[0]),d=_.rest(d))}d=o,v.step="game-distribution",v.roleList=d,v.cardSize=s,v.lineNum=$.device.w>$.device.h?c:n,v.screenType=$.device.w>$.device.h?"transverse":"vertical"}}})}();